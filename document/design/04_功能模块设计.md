# 功能模块设计文档

## 1. 系统模块划分

### 1.1 用户模块（face-sign-user）
- 用户管理
  - 用户注册
  - 用户登录
  - 用户信息管理
  - 密码管理
- 学生管理
- 教师管理
- 管理员管理

### 1.2 课程模块（face-sign-course）
- 课程管理
  - 课程创建
  - 课程编辑
  - 课程查询
  - 课程删除
- 班级管理
  - 班级创建
  - 班级编辑
  - 班级查询
  - 班级删除
- 课程安排
  - 课程表管理
  - 课程时间安排
  - 教室分配
  - 教师分配

### 1.3 考勤模块（face-sign-attendance）
- 考勤记录
  - 考勤打卡
  - 考勤查询
  - 考勤统计
  - 考勤导出
- 请假管理
  - 请假申请
  - 请假审批
  - 请假记录
  - 请假统计
- 考勤规则
  - 规则配置
  - 规则应用
  - 规则修改

### 1.4 人脸识别模块（face-sign-recognition）
- 人脸数据管理
  - 人脸采集
  - 人脸更新
  - 人脸删除
  - 人脸验证
- 人脸识别
  - 实时识别
  - 批量识别
  - 识别结果处理

### 1.5 通知模块（face-sign-notification）
- 通知管理
  - 通知发送
  - 通知接收
  - 通知查询
  - 通知删除
- 通知模板
  - 模板创建
  - 模板编辑
  - 模板应用
- 消息推送
  - 实时推送
  - 定时推送
  - 批量推送

### 1.6 系统模块（face-sign-system）
- 系统配置
  - 基础配置
  - 业务配置
  - 安全配置
- 日志管理
  - 操作日志
  - 系统日志
  - 错误日志

### 1.7 公共模块（face-sign-common）
- 公共工具
  - 工具类
  - 常量类
  - 异常类
- 公共配置
  - 配置类
  - 配置项
  - 配置管理
- 公共异常
  - 异常处理
  - 异常定义
  - 异常转换

## 2. 模块间关系

### 2.1 依赖关系
```
face-sign-boot
  ├── face-sign-user
  ├── face-sign-course
  ├── face-sign-attendance
  ├── face-sign-recognition
  ├── face-sign-notification
  ├── face-sign-system
  └── face-sign-common
```

### 2.2 数据流转
1. 用户认证流程
   ```
   用户请求 -> 用户模块 -> 权限验证 -> 业务处理
   ```

2. 考勤流程
   ```
   人脸识别 -> 考勤模块 -> 课程模块 -> 通知模块
   ```

3. 通知流程
   ```
   系统事件 -> 通知模块 -> 消息推送 -> 用户接收
   ```

## 3. 接口设计

### 3.1 接口规范
- 统一响应格式
- 统一错误处理
- 统一参数验证
- 统一接口文档

### 3.2 接口分类
1. 认证接口
   - 登录接口
   - 注册接口
   - 登出接口
   - 刷新令牌接口

2. 用户接口
   - 用户信息接口
   - 角色管理接口
   - 权限管理接口

3. 课程接口
   - 课程管理接口
   - 班级管理接口
   - 课程安排接口

4. 考勤接口
   - 考勤记录接口
   - 请假管理接口
   - 考勤统计接口

5. 人脸识别接口
   - 人脸数据接口
   - 人脸识别接口
   - 识别日志接口

6. 通知接口
   - 通知管理接口
   - 通知模板接口
   - 消息推送接口

7. 系统接口
   - 系统配置接口
   - 日志管理接口
   - 数据字典接口

## 4. 数据模型

### 4.1 实体关系
1. 用户相关
   - 用户-角色：多对多
   - 角色-权限：多对多
   - 用户-班级：多对多

2. 课程相关
   - 课程-班级：一对多
   - 课程-教师：多对多
   - 班级-学生：多对多

3. 考勤相关
   - 考勤-课程：多对一
   - 考勤-学生：多对一
   - 请假-学生：多对一

4. 通知相关
   - 通知-用户：多对多
   - 通知-模板：多对一
   - 通知-类型：多对一

### 4.2 数据流转
1. 考勤数据流
   ```
   人脸识别 -> 考勤记录 -> 考勤统计 -> 数据展示
   ```

2. 通知数据流
   ```
   系统事件 -> 通知生成 -> 消息推送 -> 用户接收
   ```

3. 课程数据流
   ```
   课程创建 -> 班级分配 -> 学生分配 -> 考勤管理
   ```

## 5. 安全设计

### 5.1 认证授权
- JWT认证
- RBAC权限控制
- 密码加密存储
- 会话管理

### 5.2 数据安全
- 数据库加密
- 敏感数据脱敏
- 数据备份策略
- 访问控制

### 5.3 应用安全
- XSS防护
- CSRF防护
- SQL注入防护
- 请求限流


